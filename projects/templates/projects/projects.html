<!-- index.html -->
{% extends 'main.html' %}
{% block content %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BookHalter - Your Intelligent Book Assistant</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'main.css' %}">
    <link rel="stylesheet" href="{% static 'responsive.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    

    <!-- Google Ads Conversion Tracking -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=AW-XXXXXXXXXX"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'AW-XXXXXXXXXX');
    </script>

    <!-- Event snippet for tracking conversion -->
    <script>
    function gtag_report_conversion(url) {
      var callback = function () {
        if (typeof(url) != 'undefined') {
          window.location = url;
        }
      };
      gtag('event', 'conversion', {
          'send_to': 'AW-XXXXXXXXXX/o24rCOLRyrsZEPi4_vI9',
          'value': 1.0,
          'currency': 'TRY',
          'event_callback': callback
      });
      return false;
    }
    </script>
</head>

<body>
    <div class="header-container">

    <h1 class="home-header">Welcome to BookHalter</h1>
    <h1 class='demo-text'>Demo</h1>
    </div>
    <p class="home-desc">
        Discover your next read with BookHalter! Answer the questions or use our reading persona feature for personalized book recommendations. Our AI suggests ten books with concise explanations based on your preferences or upvoted books. Ready to begin?
    </p>

<!-- Display the form -->
<div class="forms">
    <div class="box">
    <div class="dropdown">
        <div id="formDescription" class="form-description">Select a form to see more details.</div>
        <button class="button-17" id="formSelectBtn" class="dropbtn" >Get recommendations with Questions</button>
        <div id="formDropdown" class="dropdown-content">
            <a href="#" data-description="Use this form to answer specific questions about your reading preferences." onclick="selectForm('form1', 'Form with Questions')">Form with Questions</a>
            <a href="#" data-description="Use this form to describe your reading preferences in a paragraph." onclick="selectForm('form2', 'Form with Paragraph')">Form with Paragraph</a>
            <!-- Add more form options as needed -->
        </div>
    </div>
    <div id="cooldownMessage" class="cooldown-message" style="display: none;">Please wait for 5 minutes before requesting again!</div>
    <div id="form1" class="form-container">
        <form id="recommendationForm" method="POST" action="{% url 'recommended_books' %}">
            {% csrf_token %}
            <input type="hidden" name="action" value="by_answers">
    
    <label for="recent_reads"><i class="fas fa-book"></i> Books or authors you enjoyed:
        <span class="unique-tooltip"><i class="fas fa-info-circle"></i>
            <span class="unique-tooltiptext">Mention a book or author you've enjoyed recently. </span>
        </span>
    </label><br>
    <input type="text" id="recent_reads" name="recent_reads" placeholder="e.g., Harry Potter by J.K. Rowling"><br>
    
    <label for="desired_feeling"><i class="fas fa-smile"></i> How do you want to feel?
        <span class="unique-tooltip"><i class="fas fa-info-circle"></i>
            <span class="unique-tooltiptext">Describe the feeling you want from the next book. </span>
        </span>
    </label><br>
    <input type="text" id="desired_feeling" name="desired_feeling" placeholder="e.g., Excited, Inspired, Relaxed"><br>
    
    <label for="character_plot_preferences"><i class="fas fa-users"></i> Character and plot preferences:
        <span class="unique-tooltip"><i class="fas fa-info-circle"></i>
            <span class="unique-tooltiptext">State your preferences for characters and plot. </span>
        </span>
    </label><br>
    <input type="text" id="character_plot_preferences" name="character_plot_preferences" placeholder="e.g., Strong female lead, Mystery"><br>
    
    <label for="pacing_narrative_style"><i class="fas fa-tachometer-alt"></i> Pacing and style preferences:
        <span class="unique-tooltip"><i class="fas fa-info-circle"></i>
            <span class="unique-tooltiptext">Indicate your preferred pacing and narrative style. </span>
        </span>
    </label><br>
    <input type="text" id="pacing_narrative_style" name="pacing_narrative_style" placeholder="e.g., Fast-paced, Descriptive"><br>
    
    <button class="button-74" type="submit" id="recBtn" onclick="gtag_report_conversion()">
        <i class="fas fa-book-reader"></i> Get Book Recommendations
    </button>
</form>
                    <div class="quick-recommendation">
                <div class="quick-recommendation">
                    <form id="quickRecommendationForm" method="POST" action="{% url 'quickrecommended_books' %}">
                        <h1>Quick Book Recommendation</h1>
                        <p></p>
                        {% csrf_token %}
                        <input type="hidden" name="action" value="by_personality">
                        <button class="button-74" type="submit" id="quickRecBtn">Surprise Me!</button>
                        <span class="info-icon" id="infoIcon"><img src="{% static 'images/info.png' %}" alt="Info">
                            <div class="tooltip" id="infoTooltip">
                                <p class="tooltiptext">This feature will provide you with a book recommendation based on your reading persona that created by BookHalter without requiring you to answer any specific questions. You need to upvote at least 5 book to create your own reading persona. You need to login to use this feature.</p>
                            </div>
                        </span>
                    </form>
                </div>

                <div id="infoSection" class="info-section">

                    <script>
                        document.addEventListener('DOMContentLoaded', function() {
                            console.log("info Document loaded!");
                            var infoIcon = document.getElementById('infoIcon');
                            var infoTooltip = document.getElementById('infoTooltip');

                            if (infoIcon) {
                                console.log("infoIcon found");
                                infoIcon.addEventListener('click', function(event) {
                                    event.stopPropagation();
                                    if (infoTooltip.style.display === 'none' || infoTooltip.style.display === '') {
                                        infoTooltip.style.display = 'block';
                                    } else {
                                        infoTooltip.style.display = 'none';
                                    }
                                });

                                // Close tooltip if clicked outside
                                document.addEventListener('click', function() {
                                    infoTooltip.style.display = 'none';
                                });

                                // Prevent closing when clicking inside the tooltip
                                infoTooltip.addEventListener('click', function(event) {
                                    event.stopPropagation();
                                });
                            } else {
                                console.error("infoIcon not found in the DOM");
                            }
                        });
                    </script>
                </div>
            </div>

        

    </div>
    <div id="form2" class="form-container" style="display: none;">
        <form id="paragraphForm" method="POST" action="{% url 'recommended_books' %}">
            {% csrf_token %}
            <input type="hidden" name="action" value="by_paragraph">
            <label for="self_description">Describe yourself and your reading preferences:</label><br>
            <textarea id="self_description" name="self_description" placeholder="Write your description here..." rows="5" cols="40"></textarea><br>
            <button class="button-74" type="submit" id="paraBtn">Get Book Recommendations</button>
        </form>
    </div>

    </div>
    <div class="box">
        <body data-get-read-books-url="{% url 'get_read_books' %}"></body>
        <h1 class="readedbooktext">Favorite Books</h1>
    <div class="read-books-container" id="readBooksList">
        <!-- Books will be loaded here by JavaScript -->
    </div>
    <!-- Loading spinner -->
    <div id="loading" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 100;">
        <div class="loader">Loading...</div>
    </div>
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div id="loading" class="loader"></div>
    </div>

    </div>
    <div class="mostrecommendedbooksbox">
        <h1 class="mostrecommendedbookstext">Most Recommended Books by AI</h1>
        <div class="mostrecommendedbookscontainer" id="mostRecommendedBooksList">
            {% for book in most_recommended_books %}
            <div class="mostrecommendedbook">
                <a href="{% url 'book-detail' book.id %}">
                    <img src="{{ book.cover_image_url }}" alt="Cover image for {{ book.title }}">
                </a>

                
            </div>
            {% endfor %}
        </div>
    </div>
    
</div>
    


<div id="bookColumns" class="book-columns">
    <h2 id="aiRecommendationHeader">AI recommends these books for you</h2>
    <div id="column1" class="book-column"></div>
    <div id="column2" class="book-column"></div>
</div>




    <!-- Text for Result -->
    <p id="resultText"></p>
    <!-- Include jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

     

        <!-- Login Warning Modal -->
    <div id="loginWarningModal" class="modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Login Required</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <p>You must be logged in to use this feature.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" onclick="window.location.href='/login/'">Login</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!--  cookie banner -->
    <div id="cookie-consent-banner">
        This website uses cookies to ensure you get the best experience.
        <button onclick="acceptCookies()">Accept</button>
    </div>

    


    <script src="{% static 'scripts.js' %}"></script>

</body>
</html>
{% endblock %}